# Challenge_3_SteelData-MySQL-
[Link to Steel Data Challenge 3](https://steeldata.org.uk/sql3.html)


![wdqdqwqdw](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/c8253233-6a9d-44af-ae8f-714e10944710)

### QUESTIONS:
 1. What are the names of all the countries in the country table?
 2. What is the total number of customers in the customers table?
 3. What is the average age of customers who can receive marketing emails (can_email is set to 'yes')?
 4. How many orders were made by customers aged 30 or older?
 5. What is the total revenue generated by each product category?
 6. What is the average price of products in the 'food' category?
 7. How many orders were made in each sales channel (sales_channel column) in the orders table?
 8. What is the date of the latest order made by a customer who can receive marketing emails?
 9. What is the name of the country with the highest number of orders?
 10. What is the average age of customers who made orders in the 'vitamins' product category? 

### ANSWERS:


1. What are the names of all the countries in the country table?

```
SELECT
 country_name

FROM country;
```
![dwqq2](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/4e1cfdb9-bd06-471f-93d0-764ad3d3c266)
--
 2. What is the total number of customers in the customers table?

```
SELECT
 COUNT( DISTINCT customer_id) AS Number_of_Customers

FROM customers;
```

![qwdwqdwdq](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/d28d1850-e954-433c-ae95-3ec269939856)
--
 3. What is the average age of customers who can receive marketing emails (can_email is set to 'yes')?

```
SELECT 
 ROUND(AVG(age))AS Average_Age_Client

FROM customers
WHERE can_email = 'yes' ;
```

![wdqwqdxzc](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/61ee8b4a-77d4-4415-a90b-99c6f76f07ae)
--
 4. How many orders were made by customers aged 30 or older?

```
SELECT
 COUNT(o.order_id) AS Orders

FROM customers c
LEFT JOIN orders o
ON c.customer_id = o.customer_id
WHERE c.age > 29;
```

![qwdwdqdwqdqw](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/2b018199-65f5-4ea6-9539-bab12ce57b73)
--
 5. What is the total revenue generated by each product category?

```
SELECT 
 p.category,
 b.product_id,
 p.price AS price_of_product,
 COUNT(b.order_id) as orders,
 SUM(COUNT(b.order_id) * p.price) OVER(PARTITION BY  p.category) AS Revenue_of_category

FROM products p
LEFT JOIN baskets b
ON p.product_id = b.product_id
GROUP BY 1,2,3;
```

![wqddwqwqdqwd](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/bcc67ad3-f7f0-4903-a9a1-8928d095d90c)
--

 6. What is the average price of products in the 'food' category?

```
SELECT

category,
rev
FROM (SELECT 
DISTINCT p.category,
b.product_id,
 p.price,
COUNT(b.order_id) as orders,
SUM(COUNT(b.order_id) * p.price) OVER(PARTITION BY p.category) AS rev

FROM products p
LEFT JOIN baskets b
ON p.product_id = b.product_id
WHERE p.category = 'food'
GROUP BY 1,2,3
) as f
;
```
![qwfqwqwqfw](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/46d333e3-a5c8-4e07-a9ba-d94ae9839a93)
--

 7. How many orders were made in each sales channel (sales_channel column) in the orders table?

```
SELECT
sales_channel, 
COUNT(order_id) AS Order_by_channel
FROM orders
GROUP BY 1;
```
![fqwwqwfqfwq](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/9ae68105-8f48-42e7-aa60-8ac4c3ff11d8)
--

 8. What is the date of the latest order made by a customer who can receive marketing emails?

```
SELECT 
	MAX(o.date_shop),
	c.can_email

FROM orders o 
JOIN customers c
ON o.customer_id = c.customer_id
WHERE c.can_email = 'yes'
ORDER BY o.date_shop DESC;
```
![ascasccsacas](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/4820b14e-f679-43f3-9c5a-2350508c9cde)
--

 9. What is the name of the country with the highest number of orders?
    
```
SELECT c.country_name,
COUNT(o.order_id)
FROM country c
JOIN orders o
ON c.country_id = o.country_id
GROUP BY 1
ORDER BY 2 DESC ;
```

![wqdwdqwdqdqwdqw](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/d21d6586-cc75-4a3f-b617-9a3d4a6e69bb)
--

 10. What is the average age of customers who made orders in the 'vitamins' product category?

```
SELECT 
AVG(c.age) AS average_age_customer,
p.category
FROM customers c
JOIN orders o 
ON c.customer_id = o.customer_id
JOIN baskets b 
ON o.order_id = b.order_id
JOIN products p 
ON b.product_id = p.product_id
WHERE p.category = 'vitamins';
```

![wwqdwdqwqdwdq](https://github.com/mfernandezcean/Challenge_3_SteelData-MySQL-/assets/105746149/e3f2c98a-8d41-4b44-96e1-f8ee50ed09fe)


